SELECT service AS service_name,
SUM(patients_admitted) AS total_patients_admitted,
AVG(patient_satisfaction) AS avg_satisfaction,
CASE
WHEN AVG(patient_satisfaction) >=85 THEN 'Excellent'
WHEN AVG(patient_satisfaction) >=75 THEN 'Good'
WHEN AVG(patient_satisfaction) >=65 THEN 'Fair'
ELSE 'Needs Improvement'
END AS service_performance
FROM services_weekly
GROUP BY service
ORDER BY avg_satisfaction DESC;
