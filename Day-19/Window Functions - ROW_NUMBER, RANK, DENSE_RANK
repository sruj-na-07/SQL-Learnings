SELECT 
    service,
    week,
    patient_satisfaction,
    patients_admitted,
    rnk
FROM (
    SELECT 
        service,
        week,
        patient_satisfaction,
        patients_admitted,
        RANK() OVER (
            PARTITION BY service
            ORDER BY patient_satisfaction DESC
        ) AS rnk
    FROM services_weekly
) 
WHERE rnk <= 3
ORDER BY service, rnk, week;
