SELECT s.staff_id, s.staff_name, s.role, s.service,
COUNT (ss.week) AS weeks_present
FROM staff AS s
LEFT JOIN staff_schedule AS ss ON ss.staff_id = s.staff_id
GROUP BY s.staff_id, s.staff_name, s.role, s.service
ORDER BY SUM(ss.present) DESC;
